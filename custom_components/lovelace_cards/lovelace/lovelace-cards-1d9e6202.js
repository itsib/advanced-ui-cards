const a=Object.getPrototypeOf(customElements.get("home-assistant-main")),{html:t,css:e}=a.prototype;var o=e`:host{display:block}.dc-gauge{filter:none;position:relative}.dc-gauge .gauge{position:relative;z-index:1}.dc-gauge .gauge.animated{animation-duration:.8s;animation-name:flicker;animation-timing-function:linear}.dc-gauge .value{left:0;position:absolute;right:0;text-align:center;transform:translateY(-100%);z-index:2}.dc-gauge .label{font-size:16px;margin-top:10px;position:relative;text-align:center;width:100%;z-index:3}.dc-gauge.disabled .gauge{filter:grayscale(1) brightness(.6)}@keyframes flicker{0%,19.999%,22%,62.999%,64%,64.999%,70%,to{filter:grayscale(1) brightness(.6)}20%,21.999%,63%,63.999%,65%,69.999%{filter:none}}`;async function i(a,t,e=!1){return new Promise((async(o,i)=>{if(!a)return i(new Error("Target element not provided"));let r;return r=e?await async function(a){if(a.shadowRoot)return a.shadowRoot;return new Promise((t=>{const e=a.attachShadow;a.attachShadow=o=>(setTimeout((()=>t(a.shadowRoot))),e.call(a,o))}))}(a):a,o(r.querySelector(t))}))}function r(a,t){const e=Number(t);if(!isNaN(e))return e.toLocaleString(function(a){switch(a.locale.number_format){case"comma_decimal":return["en-US","en"];case"decimal_comma":return["de","es","it"];case"space_comma":return["fr","sv","cs"];case"system":return;default:return a.locale.language}}(a))}let s;class n extends a{constructor(){super(...arguments),this.label="",this.unit="",this.min=0,this.max=100,this.disabled=!1,this._value=0,this._disabled=!1,this._animated=!1}firstUpdated(a){super.firstUpdated(a),async function(a){s||(s=window.loadCardHelpers().then((t=>{const e=Object.keys(a.entities).find((a=>a.startsWith("sensor.")));t.createCardElement({type:"gauge",entity:e})})))}(this.hass),i(this,"ha-gauge",!0).then((a=>i(a,"svg.text",!0))).then((a=>{a&&(a.style.visibility="hidden")}))}willUpdate(a){var t;super.willUpdate(a),a.has("disabled")&&(this.disabled?(this._animated=!1,this._animationTimeout&&clearTimeout(this._animationTimeout)):this._disabled!==this.disabled&&(this._animated=!0,this._value=this.max,this._animationTimeout=setTimeout((()=>{this._value=this.min,this._animationTimeout=setTimeout((()=>{var a;this._value=null!==(a=this.value)&&void 0!==a?a:0,this._animated=!1,this._animationTimeout=void 0}),1100)}),1100)),this._disabled=this.disabled),!a.has("value")&&!a.has("disabled")||this.disabled||this._animated||this._value===this.value||(this._value=null!==(t=this.value)&&void 0!==t?t:0),(a.has("min")||a.has("disabled"))&&this.disabled&&!this._animated&&this._value!==this.min&&(this._value=this.min)}render(){const a=this.disabled||void 0===this.value;return t`<div class="${"dc-gauge "+(a?"disabled":"")}"><div class="${"gauge "+(this._animated?"animated":"")}"><ha-gauge .min="${this.min}" .max="${this.max}" .value="${this._value}" .needle="${!0}" .levels="${this.levels}" .locale="${this.hass.locale}"></ha-gauge></div><div class="value">${this._formatValue()}</div><div class="label">${this.label}</div></div>`}_formatValue(){return this.disabled||this._animated||void 0===this._value||isNaN(this._value)?`--${this.unit}`:`${r(this.hass,this.value)}${this.unit}`}}n.properties={hass:{attribute:!0},label:{attribute:!0,type:String},unit:{attribute:!0,type:String},min:{attribute:!0,type:Number},max:{attribute:!0,type:Number},levels:{attribute:!0},value:{attribute:!0,type:Number},disabled:{attribute:"disabled",reflect:!0,type:Boolean},_value:{state:!0,type:Number},_animated:{state:!0,type:Boolean}},n.styles=o,window.customElements.define("dc-gauge",n);var l=e`:host{--ha-icon-display:block;--mdc-icon-button-size:40px;--mdc-icon-size:24px;--mdc-theme-primary:var(--button-icon-color,var(--disabled-text-color,#6f6f6f));-webkit-font-smoothing:var(--paper-font-body1_-_-webkit-font-smoothing);color:var(--button-icon-color,var(--disabled-text-color,#6f6f6f));font-family:var(--paper-font-body1_-_font-family);font-size:var(--paper-font-body1_-_font-size);font-weight:var(--paper-font-body1_-_font-weight);line-height:var(--paper-font-body1_-_line-height);position:relative}:host:before{background-color:currentcolor;border-radius:50%;content:" ";height:var(--mdc-icon-button-size);left:0;opacity:.15;position:absolute;right:0;width:var(--mdc-icon-button-size)}`;class d extends a{constructor(){super(...arguments),this.loading=!1,this.disabled=!1}render(){return t`<mwc-icon-button class="circle-button" .disabled="${this.disabled}" .title="${this.title}">${this.loading&&!this.disabled?t`<mwc-circular-progress indeterminate density="${-6}"></mwc-circular-progress>`:t`<ha-icon icon="${this.icon}" class="icon"></ha-icon>`}</mwc-icon-button>`}}d.properties={hass:{attribute:!0},icon:{attribute:!0,type:String},label:{attribute:!0,type:String},loading:{attribute:"loading",reflect:!0,type:Boolean},disabled:{attribute:"disabled",reflect:!0,type:Boolean}},d.styles=l,window.customElements.define("dc-circle-button",d);var c={version:"Version",cpu:"CPU",ram:"RAM",yes:"Yes",cancel:"Cancel",are_you_sure:"Are you sure?"},p={name:"Area Card",description:"Custom area card. Displays supported entities.",config:{name:{label:"Card or area name",helper:"Name of the card or the area"},area:{label:"Area",helper:"Select the zone to be displayed"}}},h={name:"MariaDB Card",description:"Shows the status of the database. It also allows you to stop/start, restart and start cleaning.",db_size:"DB Size",purge:{tooltip:"Clean up the database",dialog:"The database cleanup process will be started."},reload:{tooltip:"Restart the database server",dialog:"The database server will be restarted."},stop:{tooltip:"Stopping the DB server",dialog:"The database server will be stopped."},start:{tooltip:"Start the database server",dialog:"The database server will be started."},error_db_stopped:"The database server now is stopped."},b={common:c,area:p,mariadb:h},u={version:"Версия:",cpu:"CPU",ram:"RAM",yes:"Да",cancel:"Отмена",are_you_sure:"Вы уверены?"},g={name:"Пространство",description:"Пользовательская карточка пространства. Отображает поддерживаемые сущности.",config:{name:{label:"Card or area name",helper:"Name of the card or the area"},area:{label:"Area",helper:"Select the zone to be displayed"}}},m={name:"Карточка MariaDB",description:"Показывает состояние базы данных. Так же позволяет останавливать/запускать, перезапускать и запускать очистку.",db_size:"Размер БД",purge:{tooltip:"Запуск отчистки БД",dialog:"Будет запущен процесс очистки БД."},reload:{tooltip:"Перезапуск сервера БД",dialog:"Сервер баз данных будет перезапущен."},stop:{tooltip:"Остановка сервера БД",dialog:"Сервер баз данных будет остановлен."},start:{tooltip:"Запустить сервер БД",dialog:"Сервер баз данных будет запущен."},error_db_stopped:"Сервер баз данных сейчас остановлен."},v={common:u,area:g,mariadb:m};const f={en:Object.freeze({__proto__:null,common:c,area:p,mariadb:h,default:b}),ru:Object.freeze({__proto__:null,common:u,area:g,mariadb:m,default:v})};function _(a,t){if("string"==typeof t)return t;const e=a.split("."),[o,...i]=e,r=t[o];return r&&"string"!=typeof r?_(i&&i.length>0?i.join("."):"",r):r}function w(a,t="",e=""){const o=function(){var a;let t=null===(a=localStorage.getItem("selectedLanguage"))||void 0===a?void 0:a.replace(/['"]+/g,"").replace("-","_");return"null"===t&&(t=void 0),t||(t=localStorage.getItem("i18nextLng")),t&&"null"!==t||(t="en"),t}();let i;try{i=Object.assign({},f[o])}catch(a){i=Object.assign({},f.en)}let r=_(a,i);return void 0===r&&(r=_(a,Object.assign({},f.en))),r&&""!==t&&""!==e&&(r=r.replace(`{${t}}`,e)),null!=r?r:""}var y,$,x=e`[aria-label][data-tooltip-pos][data-tooltip-pos=top]:before{border:var(--tooltip-arrow-size,6px) solid transparent;height:0;width:0}:host{-webkit-font-smoothing:var(--paper-font-body1_-_-webkit-font-smoothing);color:var(--primary-text-color);font-family:var(--paper-font-body1_-_font-family);font-size:var(--paper-font-body1_-_font-size);font-weight:var(--paper-font-body1_-_font-weight);line-height:var(--paper-font-body1_-_line-height)}[aria-label][data-tooltip-pos]{cursor:pointer;position:relative}[aria-label][data-tooltip-pos]:after{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-color:var(--tooltip-bg-color,rgba(var(--rgb-secondary-background-color),.95));border:var(--tooltip-border-width,.5px) solid var(--tooltip-border-color,var(--divider-color));border-radius:var(--tooltip-border-radius,4px);box-shadow:0 0 .1875rem rgba(0,0,0,.3);color:var(--tooltip-text-color,var(--primary-text-color));content:attr(aria-label);font-family:var(--paper-font-body1_-_font-family);font-size:var(--tooltip-font-size,12px);font-style:normal;font-weight:400;padding:.5em 1em;text-indent:0;text-shadow:none;white-space:nowrap;z-index:10}[aria-label][data-tooltip-pos]:before{content:"";z-index:11}[aria-label][data-tooltip-pos]:after,[aria-label][data-tooltip-pos]:before{box-sizing:border-box;opacity:0;pointer-events:none;position:absolute;transition:all .12s ease-out .12s;transition-delay:var(--tooltip-delay-hide,0s)}[aria-label][data-tooltip-pos]:focus:after,[aria-label][data-tooltip-pos]:focus:before,[aria-label][data-tooltip-pos]:hover:after,[aria-label][data-tooltip-pos]:hover:before{opacity:1;transition-delay:var(--tooltip-delay-show,0s)}[aria-label][data-tooltip-pos][data-tooltip-pos=top]:after{margin-bottom:calc(var(--tooltip-arrow-size, 6px)*2)}[aria-label][data-tooltip-pos][data-tooltip-pos=top]:before{border-top-color:var(--tooltip-border-color,var(--divider-color));filter:drop-shadow(0 1px rgba(0,0,0,.3))}[aria-label][data-tooltip-pos][data-tooltip-pos=top]:after,[aria-label][data-tooltip-pos][data-tooltip-pos=top]:before{bottom:calc(100% - var(--tooltip-arrow-size, 6px)/2);left:50%;transform:translate(-50%,6px);transform-origin:top}[aria-label][data-tooltip-pos][data-tooltip-pos=top]:focus:after,[aria-label][data-tooltip-pos][data-tooltip-pos=top]:focus:before,[aria-label][data-tooltip-pos][data-tooltip-pos=top]:hover:after,[aria-label][data-tooltip-pos][data-tooltip-pos=top]:hover:before{transform:translate(-50%)}.mariadb-card .card-header{display:flex;padding:16px}.mariadb-card .card-header .logo{height:40px;width:auto}.mariadb-card .card-header .info{padding-left:16px}.mariadb-card .card-header .info .name{color:var(--ha-card-header-color,--primary-text-color);font-size:22px;line-height:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mariadb-card .card-header .info .version{color:var(--secondary-text-color);font-size:14px;line-height:1;margin-top:4px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mariadb-card .card-content{align-items:center;display:flex;justify-content:space-between;margin:0;padding:0 10px}.mariadb-card .card-content .gauge-wrap{margin:0 6px;width:132px}.mariadb-card .card-footer{border-top:1px solid var(--entities-divider-color,var(--divider-color));display:flex;justify-content:space-between;margin:16px;padding-top:16px}.mariadb-card .card-footer .database-size{align-items:center;display:flex}.mariadb-card .card-footer .database-size .icon{height:auto;width:42px}.mariadb-card .card-footer .database-size .value{font-size:16px;margin-left:14px}.mariadb-card .card-footer .actions{display:flex;margin-right:-8px}.mariadb-card .card-footer .actions .btn-wrap{padding:0 8px}.mariadb-card .card-footer .actions .btn-wrap.purge{--button-icon-color:var(--info-color)}.mariadb-card .card-footer .actions .btn-wrap.reload{--button-icon-color:var(--warning-color)}.mariadb-card .card-footer .actions .btn-wrap.stop{--button-icon-color:var(--error-color)}.mariadb-card .card-footer .actions .btn-wrap.start{--button-icon-color:var(--success-color)}`;!function(a){a.PURGE="purge",a.RELOAD="reload",a.STOP="stop",a.START="start"}(y||(y={})),function(a){a.STARTED="started",a.STOPPED="stopped",a.RUNNING="running",a.UNKNOWN="unknown"}($||($={}));class S extends a{constructor(){super(...arguments),this._works=!1}setConfig(a={}){this.config=a}getCardSize(){return 3}firstUpdated(){const a={endpoint:`/addons/${S.dbAddonSlug}/info`,method:"get",type:"supervisor/api"};this.hass.callWS(a).then((a=>{this._name=a.name,this._version=a.version,this._works=a.state===$.STARTED})).catch(console.error)}willUpdate(a){var t;if(super.willUpdate(a),this.hass&&a.has("hass")){const a=!!(null===(t=this.hass.themes)||void 0===t?void 0:t.darkMode);a!==this._dark&&(this._dark=a)}}async connectedCallback(){await super.connectedCallback(),this._addonStateUnsubscribe=await async function(a){const{conn:t}=await hassConnection;return await t.subscribeMessage((t=>{"addon"===t.event&&t.slug===S.dbAddonSlug&&a(t.state)}),{type:"supervisor/subscribe"})}((a=>this._works=a===$.STARTED)).catch((a=>{console.error(a)}))}async disconnectedCallback(){var a;await super.disconnectedCallback(),null===(a=this._addonStateUnsubscribe)||void 0===a||a.call(this)}render(){if(!this.hass)return t``;const a=`/lovelace-cards/mariadb-logo-${this._dark?"white":"dark"}.svg`,e=this._bdSize();return t`<ha-card class="mariadb-card"><div class="card-header"><img .src="${a}" class="logo" alt="MariaDB"><div class="info"><div class="name">${this._name}</div>${this._version?t`<div class="version">${w("common.version")} ${this._version}</div>`:null}</div></div><div class="card-content"><div class="gauge-wrap"><dc-gauge .hass="${this.hass}" .label="${"CPU"}" .unit="${"%"}" .min="${0}" .max="${10}" .levels="${[{level:0,stroke:"var(--success-color)"},{level:2,stroke:"var(--warning-color)"},{level:7,stroke:"var(--error-color)"}]}" .value="${.4}" .loading="${!1}" .disabled="${!this._works}"></dc-gauge></div><div class="gauge-wrap"><dc-gauge .hass="${this.hass}" .label="${"RAM"}" .unit="${"%"}" .min="${0}" .max="${100}" .levels="${[{level:0,stroke:"var(--info-color)"}]}" .value="${3}" .loading="${!1}" .disabled="${!this._works}"></dc-gauge></div><div class="gauge-wrap"><dc-gauge .hass="${this.hass}" .label="${"RAM"}" .unit="${"Mb"}" .min="${0}" .max="${4e3}" .levels="${[{level:0,stroke:"var(--warning-color)"}]}" .value="${245}" .loading="${!1}" .disabled="${!this._works}"></dc-gauge></div></div><div class="card-footer"><div class="database-size">${e?t`<img class="icon" src="/lovelace-cards/database-size-2.svg" alt="DB Icon"><div class="value">${this._bdSize()}</div>`:null}</div><div class="actions">${this._works?t`<div class="btn-wrap purge" data-tooltip-pos="top" aria-label="${w("mariadb.purge.tooltip")}"><dc-circle-button icon="mdi:database-cog" @click="${this._progress?void 0:this._purge}" .loading="${this._progress===y.PURGE}"></dc-circle-button></div><div class="btn-wrap reload" data-tooltip-pos="top" aria-label="${w("mariadb.reload.tooltip")}"><dc-circle-button icon="mdi:restart" @click="${this._progress?void 0:this._reload}" .loading="${this._progress===y.RELOAD}"></dc-circle-button></div><div class="btn-wrap stop" data-tooltip-pos="top" aria-label="${w("mariadb.stop.tooltip")}"><dc-circle-button icon="mdi:stop" @click="${this._progress?void 0:this._stop}" .loading="${this._progress===y.STOP}"></dc-circle-button></div>`:t`<div class="btn-wrap start" data-tooltip-pos="top" aria-label="${w("mariadb.start.tooltip")}"><dc-circle-button icon="mdi:play" @click="${this._progress?void 0:this._start}" .loading="${this._progress===y.START}"></dc-circle-button></div>`}</div></div></ha-card>${this._dialog?t`<ha-dialog .open="${!0}" @closed="${this._cancel}" heading="${this._dialog.title}" class="dialog"><div><p>${this._dialog.message}</p></div><mwc-button slot="secondaryAction" @click="${this._cancel}">CANCEL</mwc-button><mwc-button slot="primaryAction" @click="${this._confirm}">OK</mwc-button></ha-dialog>`:null}`}_bdSize(){if(S.dbSizeSensor in this.hass.states){const a=r(this.hass,this.hass.states[S.dbSizeSensor].state);if(a)return`${a} MB`}}_confirm(){if(this._dialog)switch(this._progress=this._dialog.action,this._dialog=void 0,this._progress){case y.PURGE:return this._callService("recorder","purge",{keep_days:10,apply_filter:!0,repack:!0});case y.START:return this._callSupervisorWs("start");case y.STOP:return this._callSupervisorWs("stop");case y.RELOAD:return this._callSupervisorWs("restart")}}_callService(a,t,e={}){this.hass.callService(a,t,e).then((()=>{this._progress=void 0})).catch((a=>{this._progress=void 0,console.error(a)}))}_callSupervisorWs(a){const t={endpoint:`/addons/${S.dbAddonSlug}/${a}`,method:"post",timeout:null,type:"supervisor/api"};this.hass.callWS(t).then((()=>{this._progress=void 0})).catch((a=>{this._progress=void 0,console.error(a)}))}_cancel(){this._dialog=void 0}_purge(){this._dialog={title:w("common.are_you_sure"),message:w("mariadb.purge.dialog"),action:y.PURGE}}_reload(){this._dialog={title:w("common.are_you_sure"),message:w("mariadb.reload.dialog"),action:y.RELOAD}}_stop(){this._dialog={title:w("common.are_you_sure"),message:w("mariadb.stop.dialog"),action:y.STOP}}_start(){this._dialog={title:w("common.are_you_sure"),message:w("mariadb.start.dialog"),action:y.START}}}S.styles=x,S.properties={hass:{attribute:!1},config:{attribute:!1},_name:{state:!0,type:String},_version:{state:!0,type:String},_dark:{state:!0,type:Boolean},_works:{state:!0,type:Boolean},_progress:{state:!0,type:String},_dialog:{state:!0}},S.dbSizeSensor="sensor.mariadb_database_size",S.dbAddonSlug="core_mariadb",customElements.define("dc-mariadb-card",S),window.customCards=window.customCards||[],window.customCards.push({type:"dc-mariadb-card",name:w("mariadb.name"),description:w("mariadb.description"),preview:!1,configurable:!1});var z,k,T=e`:host{--mdc-icon-button-size:40px;--mdc-icon-size:28px;-webkit-font-smoothing:var(--paper-font-body1_-_-webkit-font-smoothing);color:var(--primary-text-color);font-family:var(--paper-font-body1_-_font-family);font-size:var(--paper-font-body1_-_font-size);font-weight:var(--paper-font-body1_-_font-weight);line-height:var(--paper-font-body1_-_line-height)}.area-card{overflow:hidden;position:relative}`;class C extends a{static async getConfigElement(){return await import("./area-config-e8d1be2d.js"),document.createElement("dc-area-config")}static async getStubConfig(a){var t;const e=Object.values(a.areas)[0];return{type:"custom:dc-area-card",name:"",area:null!==(t=null==e?void 0:e.area_id)&&void 0!==t?t:""}}setConfig(a){this._config=a}render(){return t`<ha-card class="area-card"><div class="content"><h5>Area Card</h5></div></ha-card>`}getCardSize(){return 3}}C.styles=T,C.properties={hass:{attribute:!1},_config:{state:!0}},window.customElements.define("dc-area-card",C),window.customCards=window.customCards||[],window.customCards.push({type:"dc-area-card",name:w("area.name"),preview:!1,description:w("area.description")}),z="lovelace_cards",k="/lovelace-cards/logo.svg",window.brandReplacer||(window.brandReplacer=import("./brand-replacer-a313eab0.js")),window.brandReplacer.then((a=>{a.BrandReplacer.insert(z,k)}));export{C as A,n as D,a as L,d as a,e as c,t as h,w as t};
